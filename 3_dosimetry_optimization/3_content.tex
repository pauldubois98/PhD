%In modern radiotherapy, the precision of dose delivery is essential to maximize the therapeutic effect on cancerous tissues while minimizing exposure to surrounding healthy organs.
%Achieving this balance relies heavily on advanced dose optimization techniques that tailor radiation to the specific anatomical and clinical needs of each patient.
\section{Discretization}
The optimization process starts with transforming the continuous nature of both the radiation field and the human body into discrete elements.
This transformation enables computation with modern computers.

\subsection[Bixels]{Fluence Map Discretization: Bixels}
Fluence maps are broken down into discrete elements called "bixels" (\textbf{be}am \textbf{el}ements).
Bixels represent small and independent beams of radiation.

The width of each bixel is constrained by the width of the multi-leaf collimator leaves.
Modern multi-leaf collimator systems typically have a leaf width of 0.5 cm.

The height of a bixel can be selected arbitrarily, as the leaf can move continuously.
Nevertheless, square bixels (akin to image pixels) are commonly used and will be employed throughout this manuscript.

Bixels whose beams do not affect the planning target volume are typically excluded from calculations to improve computational efficiency.
Activating these bixels could only degrade dose quality by increasing the dose to organs at risk without benefiting the dose distribution within the planning target volume.

\subsection[Voxels]{Human Body Discretization: Voxels}
The human body of the patient is also divided into discrete elements, as it is a three dimensional object, the lements are "voxels" (\textbf{vo}lume \textbf{el}ements).
Each voxel represents a small portion of tissue within the patient's body, and will determine the granularity of the dose computed.

The maximum resolution of the voxel grid is defined by the planning image, which is typically a CT scan.
To reduce computational demands, it is common practice to resample the planning image.
In this manuscript, where new techniques are explored, we have opted to resample the voxel grid to a resolution of 5 mm, ensuring a balance between computational efficiency and accuracy.

Additionally, to further optimize the computational process, only voxels corresponding to the planning target volume (PTV) and organs at risk (OARs) are retained for calculations.
This selective approach reduces unnecessary computation.

\subsection[DI-Matrix]{Dose-Influence Matrix}
The Dose-Influence Matrix (or DI-Matrix) links the discretized fluence map (the bixels values) and the discretized dose distribution within the patient (the dose on each voxel).
This matrix defines how the radiation from each individual bixel influences the dose delivered to every voxel in the patientâ€™s body.

We start by converting the 2D fluence map, composed of individual bixel values, into a column vector $b$.
Similarly we represent dose distribution in the 3D space of the patient as a vector $d$, where each entry corresponds to the dose in a specific voxel.
The DI-Matrix $L$ governs the relationship between these vectors $b$ and $d$ via the matrix-vector multiplication $d = Lb$.
This mathematical operation computes the total dose at each voxel by summing the contributions from all active bixels (here, we assume that the effect of bixels is linear).

The DI-Matrix is constructed by simulating the radiation delivered by each individual bixel.
For each bixel, the jaws of the multi-leaf collimator are virtually opened to allow only that specific beamlet through.
A radiation transport model is employed to calculate the dose deposited in each voxel, taking into account the beam's spread and attenuation as it travels through the body.
The resulting 3D dose deposition is used to fill one column of the matrix $L$, corresponding to that bixel's influence on all voxels.
Repeating this process for each bixel generates the entire DI-Matrix.

The accuracy of the dose calculation dependents on the precision of the DI-Matrix.
Simple models like pencil beam approximations, which assume a linear trajectory with minimal scattering, are considered as too coarse.
In contrast, more advanced simulations, such as Monte Carlo methods, provide a detailed and accurate dose calculation, although at a higher computational cost.
In this manuscript, we employ a collapsed cone convolution techniques, which balances between efficiency and accuracy.

\section{Naive Method}
% least squares on PTV = prescription, OARs = 0
% => does not work at all
\section{Constraints and Importance Factors}
\subsection[DVHs]{Dose Volume Histograms}
% 3D dose vs DVH
\subsection{Constraints Formulation}
\subsection{Optimization Problem}
\paragraph{Ideal}
% minimize dose while reaching constraints
\paragraph{Practical}
% get as close as possible to meeting constraints
% building of cost function

\section{Dose Mimicking}
% principle
% => is a simpler problem
% => only works if dose to mimick is nearly acheaivable
% => can arise if machine is changing during treatment
% optim problem

\section{Optimization Algorithm Review for Dosimetry}
\subsection{Introduction}
% ArXiV paper

\subsection{Methods}
%Efficiently solving this optimization problem often involves designing the objective function to be convex, thereby providing a well-defined target for the optimization process.
%Gradient-based methods, Newtonian algorithms, or quasi-Newtonian algorithms are commonly employed for this purpose.
%We aim at benchmarking state-of-the-art open-source optimization algorithms for the specific task of radiotherapy dosimetry.

\subsection{Data}
% TG-119 \cite{AAPM-TG119}
\subsection{Objective function}
% details on the one used for this study
% => tested variations (p=1,2), changed importance factors, but v similar results
\subsection{Open-source Optimizers}
\paragraph{(Stochastic) Gradient Descent}
\paragraph{Conjugate Gradient}
\paragraph{Newton}
\paragraph{SLSQP}
\paragraph{RMSprop}
\paragraph{BFGS-based}
\subparagraph{Pure BFGS}
\subparagraph{L-BFGS}
\paragraph{Adam-based}
\subparagraph{Pure Adam}
\subparagraph{RAdam}
\subparagraph{NAdam}
\subparagraph{AdamDelta}
\subparagraph{Adamax}
\paragraph{Rprop}
\paragraph{Other optimizers variations}
%In addition, we also tested AdamW, Adagrad and ASGD.
%However, AdamW \& Adagrad behaved similarly to Adam, and ASGD behaved similarly to SGD.

\subsection{Results}
% 4 TGG-119 cases figures
\paragraph{Newton's method}
\paragraph{Best Algorithms}
\paragraph{LBFGS vs BFGS}

\subsection{Discussion}
